<!DOCTYPE html>
<html lang="ru" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∏ - –ø—Ä–æ–µ–∫—Ç –∫–æ–º–∞–Ω–¥—ã –†—É–¥–∏—Ä–æ–Ω—á–∏–∫–∏">
    <meta name="keywords" content="—ç–∫–æ–ª–æ–≥–∏—è, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å, –¥–∞–≤–ª–µ–Ω–∏–µ, –∏–Ω—Å–æ–ª—è—Ü–∏—è, –≥—Ä–∞—Ñ–∏–∫–∏, ThingSpeak">

    <meta name="color-scheme" content="light dark">
    <meta name="theme-color" content="#45AEAC" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#121212" media="(prefers-color-scheme: dark)">
    <meta name="supported-color-schemes" content="light dark">

    <title>–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ - –°—Ç–∞–Ω—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ | –†—É–¥–∏—Ä–æ–Ω—á–∏–∫–∏</title>

    <link rel="preload" href="styles/main.css" as="style">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/chart.js" as="script" crossorigin="anonymous">

    <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/apple-touch-icon.png">

    <link rel="stylesheet" href="styles/main.css">

    <meta property="og:title" content="–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ - –°—Ç–∞–Ω—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞">
    <meta property="og:description" content="–ü—Ä–æ–µ–∫—Ç –∫–æ–º–∞–Ω–¥—ã –†—É–¥–∏—Ä–æ–Ω—á–∏–∫–∏ –¥–ª—è –∫–µ–π—Å-—á–µ–º–ø–∏–æ–Ω–∞—Ç–∞ –ö–ê–ü–ß–ê">
    <meta property="og:image" content="assets/images/preview.jpg">
    <meta property="og:type" content="website">

    <style>
        /* –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞ */
        :root, [data-theme="light"] {
            color-scheme: light;
        }

        [data-theme="dark"] {
            color-scheme: dark;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            min-height: 100vh;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        #root:empty::after {
            content: 'üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...';
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.25rem;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫—Ä–æ–ª–ª–±–∞—Ä */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary, #f8f9fa);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--secondary, #45AEAC);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-dark, #3a9c9a);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã */
        .theme-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--secondary, #45AEAC);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            z-index: 1000;
            box-shadow: var(--shadow-lg, 0 4px 20px rgba(0,0,0,0.2));
            transition: all 0.3s ease;
            opacity: 0;
            animation: fadeIn 0.5s ease 1s forwards;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-lg, 0 6px 25px rgba(0,0,0,0.3));
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
    </style>

    <!-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã -->
    <script>
        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É –∏–∑ localStorage
        (function() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

            // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è —Ç–µ–º–∞ > —Å–∏—Å—Ç–µ–º–Ω–∞—è —Ç–µ–º–∞
            const theme = savedTheme || (prefersDark ? 'dark' : 'light');

            document.documentElement.setAttribute('data-theme', theme);
            document.documentElement.style.colorScheme = theme;

            // –û–±–Ω–æ–≤–ª—è–µ–º meta —Ç–µ–≥–∏
            const themeColorMeta = document.querySelector('meta[name="theme-color"]');
            if (themeColorMeta) {
                themeColorMeta.content = theme === 'dark' ? '#121212' : '#45AEAC';
            }

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–º—É –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ
            window.APP_THEME = theme;
        })();

        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';

            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞
            document.documentElement.style.transition = 'background-color 0.3s ease, color 0.3s ease';
            document.documentElement.setAttribute('data-theme', newTheme);
            document.documentElement.style.colorScheme = newTheme;

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('theme', newTheme);

            // –û–±–Ω–æ–≤–ª—è–µ–º meta —Ç–µ–≥–∏
            const themeColorMeta = document.querySelector('meta[name="theme-color"]');
            if (themeColorMeta) {
                themeColorMeta.content = newTheme === 'dark' ? '#121212' : '#45AEAC';
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É
            const icon = document.getElementById('theme-icon');
            if (icon) {
                icon.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                icon.setAttribute('title', newTheme === 'dark' ? '–í–∫–ª—é—á–∏—Ç—å —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É' : '–í–∫–ª—é—á–∏—Ç—å —Ç–µ–º–Ω—É—é —Ç–µ–º—É');
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
            window.APP_THEME = newTheme;

            // –£–±–∏—Ä–∞–µ–º transition –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                document.documentElement.style.transition = '';
            }, 300);

            return newTheme;
        }
    </script>
</head>
<body>
    <div id="root" aria-live="polite" aria-label="–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π"></div>

    <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã -->
    <button class="theme-toggle" onclick="toggleTheme()"
            aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É"
            title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É"
            id="theme-toggle-btn">
        <span id="theme-icon">üåô</span>
    </button>

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" crossorigin="anonymous"></script>

    <script>
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
        window.addEventListener('error', function(e) {
            console.error('–ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞:', e.error);
            const root = document.getElementById('root');
            if (root && root.innerHTML === '') {
                root.innerHTML = `
                    <div style="padding: 3rem 2rem; text-align: center; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; background: var(--bg-primary, white); color: var(--text-primary, black); font-family: 'Segoe UI', sans-serif;">
                        <div style="background: var(--bg-card, rgba(255,255,255,0.1)); padding: 2.5rem; border-radius: 1.5rem; max-width: 600px; border: 1px solid var(--border-color, rgba(255,255,255,0.2));">
                            <h2 style="margin-bottom: 1rem; font-size: 1.75rem; color: var(--text-primary, white);">‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞</h2>
                            <p style="margin-bottom: 1.5rem; opacity: 0.9; line-height: 1.6; color: var(--text-secondary, rgba(255,255,255,0.8));">
                                –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–æ–∑–Ω–∏–∫–ª–∞ –ø—Ä–æ–±–ª–µ–º–∞.<br>
                                –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å –º–µ–¥–ª–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –Ω–µ–ø–æ–ª–∞–¥–∫–∞–º–∏.
                            </p>
                            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                                <button onclick="window.location.reload()" style="padding: 0.75rem 1.5rem; background: var(--secondary, #45AEAC); color: white; border: none; border-radius: 0.75rem; cursor: pointer; font-weight: 600; transition: all 0.3s ease;">
                                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
                                </button>
                                <button onclick="location.href='./'" style="padding: 0.75rem 1.5rem; background: var(--primary, #1a1a1a); color: white; border: none; border-radius: 0.75rem; cursor: pointer; font-weight: 600; transition: all 0.3s ease;">
                                    üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }
        });

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ ThingSpeak –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', async () => {
            console.log('–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ ThingSpeak...');

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–∫–æ–Ω–∫–∏ —Ç–µ–º—ã
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const icon = document.getElementById('theme-icon');
            if (icon) {
                icon.textContent = currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                icon.setAttribute('title', currentTheme === 'dark' ? '–í–∫–ª—é—á–∏—Ç—å —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É' : '–í–∫–ª—é—á–∏—Ç—å —Ç–µ–º–Ω—É—é —Ç–µ–º—É');
            }

            setTimeout(async () => {
                if (window.DataService && window.DataService.getDataSource) {
                    const currentSource = window.DataService.getDataSource();

                    if (currentSource === 'thingspeak') {
                        try {
                            const result = await window.DataService.testThingSpeakConnection();

                            if (result.success) {
                                console.log('‚úÖ ThingSpeak –¥–æ—Å—Ç—É–ø–µ–Ω! –ö–∞–Ω–∞–ª:', result.channelName);

                                const notification = document.createElement('div');
                                notification.style.cssText = `
                                    position: fixed;
                                    top: 20px;
                                    right: 20px;
                                    background: #28a745;
                                    color: white;
                                    padding: 12px 18px;
                                    border-radius: 8px;
                                    z-index: 9999;
                                    box-shadow: var(--shadow-lg, 0 4px 12px rgba(0,0,0,0.2));
                                    font-family: 'Segoe UI', sans-serif;
                                    animation: slideIn 0.3s ease;
                                    display: flex;
                                    align-items: center;
                                    gap: 10px;
                                    border: none;
                                `;
                                notification.innerHTML = `
                                    <span style="font-size: 1.2em;">üì°</span>
                                    <div>
                                        <strong style="display: block; margin-bottom: 4px;">ThingSpeak –ø–æ–¥–∫–ª—é—á–µ–Ω</strong>
                                        <span style="font-size: 0.9em; opacity: 0.9;">–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</span>
                                    </div>
                                `;
                                document.body.appendChild(notification);

                                setTimeout(() => {
                                    notification.style.animation = 'slideOut 0.3s ease';
                                    setTimeout(() => notification.remove(), 300);
                                }, 5000);

                            } else {
                                console.warn('‚ö†Ô∏è ThingSpeak –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:', result.error);
                                showThingSpeakWarning(`ThingSpeak –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${result.error}`);
                            }
                        } catch (error) {
                            console.warn('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ ThingSpeak:', error.message);
                            showThingSpeakWarning(`–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${error.message}`);
                        }
                    } else {
                        console.log('–¢–µ–∫—É—â–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:', currentSource);
                    }
                } else {
                    console.warn('DataService –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É ThingSpeak');
                }
            }, 1000);

            function showThingSpeakWarning(message) {
                const warning = document.createElement('div');
                warning.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #ffc107;
                    color: #856404;
                    padding: 12px 18px;
                    border-radius: 8px;
                    z-index: 9999;
                    box-shadow: var(--shadow-lg, 0 4px 12px rgba(0,0,0,0.2));
                    font-family: 'Segoe UI', sans-serif;
                    animation: slideIn 0.3s ease;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    border: 1px solid #ffeaa7;
                `;
                warning.innerHTML = `
                    <span style="font-size: 1.2em;">‚ö†Ô∏è</span>
                    <div>
                        <strong style="display: block; margin-bottom: 4px;">ThingSpeak –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</strong>
                        <span style="font-size: 0.9em;">${message}<br>–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ</span>
                    </div>
                `;
                document.body.appendChild(warning);

                setTimeout(() => {
                    warning.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => warning.remove(), 300);
                }, 8000);
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ç–µ–º—ã
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–µ–Ω—è–ª —Ç–µ–º—É –≤—Ä—É—á–Ω—É—é, —Å–ª–µ–¥—É–µ–º —Å–∏—Å—Ç–µ–º–Ω–æ–π
                if (!localStorage.getItem('theme')) {
                    const newTheme = e.matches ? 'dark' : 'light';
                    document.documentElement.setAttribute('data-theme', newTheme);
                    document.documentElement.style.colorScheme = newTheme;
                    window.APP_THEME = newTheme;

                    const icon = document.getElementById('theme-icon');
                    if (icon) {
                        icon.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                    }
                }
            });
        });
    </script>

    <script src="js/utils/dateUtils.js" type="text/babel"></script>
    <script src="js/utils/chartUtils.js" type="text/babel"></script>
    <script src="js/utils/domUtils.js" type="text/babel"></script>
    <script src="js/services/DataService.js" type="text/babel"></script>
    <script src="js/components/Header.js" type="text/babel"></script>
    <script src="js/components/TeamCarousel.js" type="text/babel"></script>
    <script src="js/components/ChartContainerChartJS.js" type="text/babel"></script>
    <script src="js/components/Footer.js" type="text/babel"></script>
    <script src="js/app.js" type="text/babel"></script>
</body>
</html>