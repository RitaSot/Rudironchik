<!DOCTYPE html>
<html lang="ru" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | –†—É–¥–∏—Ä–æ–Ω—á–∏–∫–∏</title>

    <meta name="description" content="–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∏ - –ø—Ä–æ–µ–∫—Ç –∫–æ–º–∞–Ω–¥—ã –†—É–¥–∏—Ä–æ–Ω—á–∏–∫–∏">
    <meta name="keywords" content="—ç–∫–æ–ª–æ–≥–∏—è, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å, –¥–∞–≤–ª–µ–Ω–∏–µ, –∏–Ω—Å–æ–ª—è—Ü–∏—è">

    <meta name="color-scheme" content="light dark">
    <meta name="theme-color" content="#45AEAC" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#121212" media="(prefers-color-scheme: dark)">
    <meta name="supported-color-schemes" content="light dark">

    <link rel="stylesheet" href="styles/main.css">
    <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            min-height: 100vh;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        #root:empty::after {
            content: 'üîÑ –ó–∞–≥—Ä—É–∑–∫–∞...';
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.25rem;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        .theme-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--secondary, #45AEAC);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            z-index: 1000;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            opacity: 0;
            animation: fadeIn 0.5s ease 1s forwards;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-lg);
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }
    </style>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã
        (function() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = savedTheme || (prefersDark ? 'dark' : 'light');

            document.documentElement.setAttribute('data-theme', theme);
            document.documentElement.style.colorScheme = theme;

            const themeColorMeta = document.querySelector('meta[name="theme-color"]');
            if (themeColorMeta) {
                themeColorMeta.content = theme === 'dark' ? '#121212' : '#45AEAC';
            }

            window.APP_THEME = theme;
        })();

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';

            document.documentElement.style.transition = 'background-color 0.3s ease, color 0.3s ease';
            document.documentElement.setAttribute('data-theme', newTheme);
            document.documentElement.style.colorScheme = newTheme;

            localStorage.setItem('theme', newTheme);

            const themeColorMeta = document.querySelector('meta[name="theme-color"]');
            if (themeColorMeta) {
                themeColorMeta.content = newTheme === 'dark' ? '#121212' : '#45AEAC';
            }

            const icon = document.getElementById('theme-icon');
            if (icon) {
                icon.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                icon.title = newTheme === 'dark' ? '–í–∫–ª—é—á–∏—Ç—å —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É' : '–í–∫–ª—é—á–∏—Ç—å —Ç–µ–º–Ω—É—é —Ç–µ–º—É';
            }

            window.APP_THEME = newTheme;

            setTimeout(() => {
                document.documentElement.style.transition = '';
            }, 300);

            return newTheme;
        }
    </script>
</head>
<body>
    <div id="root" aria-live="polite" aria-label="–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π"></div>

    <button class="theme-toggle" onclick="toggleTheme()" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É" id="theme-toggle-btn">
        <span id="theme-icon">üåô</span>
    </button>

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" crossorigin></script>

    <script>
        window.addEventListener('error', function(e) {
            console.error('–û—à–∏–±–∫–∞:', e.error);
            const root = document.getElementById('root');
            if (root && root.innerHTML === '') {
                root.innerHTML = `
                    <div style="padding: 3rem 2rem; text-align: center; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; background: var(--bg-primary); color: var(--text-primary); font-family: 'Segoe UI', sans-serif;">
                        <div style="background: var(--bg-card); padding: 2.5rem; border-radius: 1.5rem; max-width: 600px; border: 1px solid var(--border-color);">
                            <h2 style="margin-bottom: 1rem; font-size: 1.75rem;">‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞</h2>
                            <p style="margin-bottom: 1.5rem; opacity: 0.9; line-height: 1.6;">
                                –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–æ–∑–Ω–∏–∫–ª–∞ –ø—Ä–æ–±–ª–µ–º–∞.<br>
                                –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.
                            </p>
                            <button onclick="window.location.reload()" style="padding: 0.75rem 1.5rem; background: var(--secondary); color: white; border: none; border-radius: 0.75rem; cursor: pointer; font-weight: 600;">
                                üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
                            </button>
                        </div>
                    </div>
                `;
            }
        });

        window.addEventListener('DOMContentLoaded', async () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const icon = document.getElementById('theme-icon');
            if (icon) {
                icon.textContent = currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                icon.title = currentTheme === 'dark' ? '–í–∫–ª—é—á–∏—Ç—å —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É' : '–í–∫–ª—é—á–∏—Ç—å —Ç–µ–º–Ω—É—é —Ç–µ–º—É';
            }

            setTimeout(async () => {
                if (window.DataService && window.DataService.getDataSource) {
                    const currentSource = window.DataService.getDataSource();

                    if (currentSource === 'thingspeak') {
                        try {
                            const result = await window.DataService.testThingSpeakConnection();
                            if (result.success) {
                                console.log('‚úÖ ThingSpeak –¥–æ—Å—Ç—É–ø–µ–Ω:', result.channelName);
                            }
                        } catch (error) {
                            console.warn('‚ö†Ô∏è ThingSpeak –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:', error.message);
                        }
                    }
                }
            }, 1000);

            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                if (!localStorage.getItem('theme')) {
                    const newTheme = e.matches ? 'dark' : 'light';
                    document.documentElement.setAttribute('data-theme', newTheme);
                    document.documentElement.style.colorScheme = newTheme;
                    window.APP_THEME = newTheme;

                    const icon = document.getElementById('theme-icon');
                    if (icon) {
                        icon.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                    }
                }
            });
        });
    </script>

    <script src="js/utils/dateUtils.js"></script>
    <script src="js/utils/chartUtils.js"></script>
    <script src="js/utils/domUtils.js"></script>
    <script src="js/services/DataService.js"></script>
    <script src="js/components/Header.js"></script>
    <script src="js/components/TeamCarousel.js"></script>
    <script src="js/components/ChartContainerChartJS.js"></script>
    <script src="js/components/Footer.js"></script>
    <script src="js/app.js"></script>
</body>
</html>